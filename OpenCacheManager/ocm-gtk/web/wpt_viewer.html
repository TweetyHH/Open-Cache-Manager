<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <style type="text/css">
#map {
        width: 100%;
        height: 100%;
        border: 0px;
        padding: 0px;
        position: absolute;
     }
body {
        border: 0px;
        margin: 0px;
        padding: 0px;
        height: 100%;
     }
    </style>
    <script src="http://www.openlayers.org/api/OpenLayers.js"></script>
    <script src="http://www.openstreetmap.org/openlayers/OpenStreetMap.js"></script>

    <script type="text/javascript">
        <!--
        // complex map object
        var map;
 
	// Start position for the map (hardcoded here for simplicity,
	// but maybe you want to get from URL params)
	var lat = 45.39271;
	var lon = -75.63399;
	var zoom = 14;
	var pois;
	var notify;
 
        function init(){
            map = new OpenLayers.Map('map',
                    { maxExtent: new OpenLayers.Bounds(-20037508.34,-20037508.34,20037508.34,20037508.34),
                      numZoomLevels: 19,
                      maxResolution: 156543.0399,
                      units: 'm',
                      projection: new OpenLayers.Projection("EPSG:900913"),
                      displayProjection: new OpenLayers.Projection("EPSG:4326")
                    });
 
            var layerMapnik = new OpenLayers.Layer.OSM.Mapnik("Mapnik");
 
            var layerTah = new OpenLayers.Layer.OSM.Osmarender("Tiles@Home");

	  
            map.addLayers([layerMapnik,layerTah]);
            map.addControl(new OpenLayers.Control.LayerSwitcher());
 
            var lonLat = new OpenLayers.LonLat(lon, lat).transform(map.displayProjection,  map.projection);
            if (!map.getCenter()) map.setCenter (lonLat, zoom);
            clearMarkers();
        }
        
    function clearMarkers()
    {
    	if (pois)	    
			pois.destroy();  
		if (notify)	    
			notify.destroy();
    	pois = new OpenLayers.Layer.Markers( "Waypoints" );
    	map.addLayer(pois);
    }

	function addMarker(lat, lon, icon)
	{
		var size = new OpenLayers.Size(24,24);
		var offset = new OpenLayers.Pixel(-(size.w/2), -size.h);
		var icon = new OpenLayers.Icon(icon,size,offset);
		var lonlat = new OpenLayers.LonLat(lon, lat).transform(map.displayProjection,  map.projection);
		pois.addMarker(new OpenLayers.Marker(lonlat,icon));
	    map.setCenter (lonlat, 14);
	}


	function zoomToPoint(lat, lon)
	{
		var lonLat = new OpenLayers.LonLat(lon, lat).transform(map.displayProjection,  map.projection);	
		if (notify)	    
			notify.destroy();
		notify = new OpenLayers.Layer.Markers( "Notify" );
		var size = new OpenLayers.Size(48,48);
		var offset = new OpenLayers.Pixel(-(size.w/2), -(size.h/1.33));
		var icon = new OpenLayers.Icon("../icons/48x48/circle.png",size,offset);
		notify.addMarker(new OpenLayers.Marker(lonLat,icon));  	
		map.addLayer(notify);
		map.panTo(lonLat);
	}
        // -->
    </script>
  </head>
  <body onload="init()">
    <div id="map"></div>
  </body>
</html>
